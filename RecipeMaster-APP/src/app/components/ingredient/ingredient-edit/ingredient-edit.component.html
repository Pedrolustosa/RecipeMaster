<div class="container-fluid py-3">
  <div class="row">
    <div class="col-md-9">
      <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center bg-primary text-white">
          <h5 class="mb-0">
            <i class="fas fa-edit me-2"></i>Edit Ingredient
          </h5>
        </div>
        
        <div class="card-body">
          <form [formGroup]="ingredientForm" (ngSubmit)="onSubmit()">
            <ul class="nav nav-tabs mb-3" id="ingredientTabs" role="tablist">
              <li class="nav-item" role="presentation">
                <button class="nav-link active" id="basic-tab" data-bs-toggle="tab" data-bs-target="#basic" type="button" role="tab">
                  <i class="fas fa-info-circle me-2"></i>Basic Info
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button class="nav-link" id="details-tab" data-bs-toggle="tab" data-bs-target="#details" type="button" role="tab">
                  <i class="fas fa-dollar-sign me-2"></i>Details
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button class="nav-link" id="storage-tab" data-bs-toggle="tab" data-bs-target="#storage" type="button" role="tab">
                  <i class="fas fa-warehouse me-2"></i>Storage
                </button>
              </li>
            </ul>

            <div class="tab-content" id="ingredientTabContent">
              <!-- Basic Info Tab -->
              <div class="tab-pane fade show active" id="basic" role="tabpanel">
                <div class="row g-3">
                  <div class="col-md-6">
                    <label for="name" class="form-label fw-bold">Name</label>
                    <input type="text" class="form-control" id="name" formControlName="name" placeholder="Enter ingredient name"
                      [ngClass]="{'is-invalid': submitted && f['name'].errors}">
                    <div *ngIf="submitted && f['name'].errors" class="invalid-feedback">
                      <div *ngIf="f['name'].errors['required']">Name is required for ingredient identification</div>
                      <div *ngIf="f['name'].errors['minlength']">Name must be at least 3 characters to be descriptive</div>
                      <div *ngIf="f['name'].errors['maxlength']">Name cannot exceed 100 characters</div>
                    </div>
                    <small class="text-muted">{{fieldInstructions.name}}</small>
                  </div>

                  <div class="col-md-6">
                    <label for="unit" class="form-label fw-bold">Unit of Measure</label>
                    <select class="form-select" id="unit" formControlName="unit"
                      [ngClass]="{'is-invalid': submitted && f['unit'].errors}">
                      <option value="">Select unit</option>
                      <option *ngFor="let unit of measurementUnits" [value]="unit">
                        {{unit}}
                      </option>
                    </select>
                    <div *ngIf="submitted && f['unit'].errors" class="invalid-feedback">
                      <div *ngIf="f['unit'].errors['required']">Please select a measurement unit to specify how this ingredient will be measured</div>
                    </div>
                    <small class="text-muted">{{fieldInstructions.unit}}</small>
                  </div>

                  <div class="col-12">
                    <label for="description" class="form-label fw-bold">Description</label>
                    <textarea class="form-control" id="description" rows="3" formControlName="description"
                      placeholder="Describe the ingredient" [ngClass]="{'is-invalid': submitted && f['description'].errors}"></textarea>
                    <div *ngIf="submitted && f['description'].errors" class="invalid-feedback">
                      <div *ngIf="f['description'].errors['required']">Description helps users understand the ingredient's characteristics</div>
                      <div *ngIf="f['description'].errors['minlength']">Description must be at least 10 characters to be meaningful</div>
                      <div *ngIf="f['description'].errors['maxlength']">Description cannot exceed 500 characters</div>
                    </div>
                    <small class="text-muted">{{fieldInstructions.description}}</small>
                  </div>
                </div>
              </div>

              <!-- Details Tab -->
              <div class="tab-pane fade" id="details" role="tabpanel">
                <div class="row g-3">
                  <div class="col-md-6">
                    <label for="cost" class="form-label fw-bold">Cost per Unit</label>
                    <div class="input-group">
                      <span class="input-group-text">$</span>
                      <input type="number" class="form-control" id="cost" formControlName="cost" step="0.01"
                        placeholder="0.00" [ngClass]="{'is-invalid': submitted && f['cost'].errors}">
                    </div>
                    <div *ngIf="submitted && f['cost'].errors" class="invalid-feedback">
                      <div *ngIf="f['cost'].errors['required']">Cost is required for recipe pricing calculations</div>
                      <div *ngIf="f['cost'].errors['min']">Cost must be at least $0.01</div>
                      <div *ngIf="f['cost'].errors['max']">Cost cannot exceed $999.99</div>
                    </div>
                    <small class="text-muted">{{fieldInstructions.cost}}</small>
                  </div>
                </div>
              </div>

              <!-- Storage Tab -->
              <div class="tab-pane fade" id="storage" role="tabpanel">
                <div class="row g-3">
                  <div class="col-md-6">
                    <label for="stockQuantity" class="form-label fw-bold">Stock Quantity</label>
                    <input type="number" class="form-control" id="stockQuantity" formControlName="stockQuantity"
                      placeholder="Enter current stock" [ngClass]="{'is-invalid': submitted && f['stockQuantity'].errors}">
                    <div *ngIf="submitted && f['stockQuantity'].errors" class="invalid-feedback">
                      <div *ngIf="f['stockQuantity'].errors['required']">Stock quantity is required for inventory management</div>
                      <div *ngIf="f['stockQuantity'].errors['min']">Stock quantity cannot be negative</div>
                      <div *ngIf="f['stockQuantity'].errors['max']">Stock quantity cannot exceed 9999</div>
                    </div>
                    <small class="text-muted">Enter the current quantity of this ingredient in stock.</small>
                  </div>

                  <div class="col-md-6">
                    <label for="minimumStockLevel" class="form-label fw-bold">Minimum Stock Level</label>
                    <input type="number" class="form-control" id="minimumStockLevel" formControlName="minimumStockLevel"
                      placeholder="Enter minimum stock level" [ngClass]="{'is-invalid': submitted && f['minimumStockLevel'].errors}">
                    <div *ngIf="submitted && f['minimumStockLevel'].errors" class="invalid-feedback">
                      <div *ngIf="f['minimumStockLevel'].errors['required']">Minimum stock level is required for inventory alerts</div>
                      <div *ngIf="f['minimumStockLevel'].errors['min']">Minimum stock level cannot be negative</div>
                      <div *ngIf="f['minimumStockLevel'].errors['max']">Minimum stock level cannot exceed 9999</div>
                    </div>
                    <small class="text-muted">Enter the minimum quantity of this ingredient to maintain in stock.</small>
                  </div>

                  <div class="col-md-6">
                    <label for="supplierName" class="form-label fw-bold">Supplier Name</label>
                    <input type="text" class="form-control" id="supplierName" formControlName="supplierName"
                      placeholder="Enter supplier name" [ngClass]="{'is-invalid': submitted && f['supplierName'].errors}">
                    <div *ngIf="submitted && f['supplierName'].errors" class="invalid-feedback">
                      <div *ngIf="f['supplierName'].errors['required']">Supplier name is required for purchasing</div>
                      <div *ngIf="f['supplierName'].errors['minlength']">Supplier name must be at least 2 characters</div>
                      <div *ngIf="f['supplierName'].errors['maxlength']">Supplier name cannot exceed 100 characters</div>
                    </div>
                    <small class="text-muted">Enter the name of the supplier for this ingredient.</small>
                  </div>

                  <div class="col-md-6">
                    <label for="originCountry" class="form-label fw-bold">Country of Origin</label>
                    <input type="text" class="form-control" id="originCountry" formControlName="originCountry"
                      placeholder="Enter country of origin" [ngClass]="{'is-invalid': submitted && f['originCountry'].errors}">
                    <div *ngIf="submitted && f['originCountry'].errors" class="invalid-feedback">
                      <div *ngIf="f['originCountry'].errors['required']">Country of origin is required</div>
                      <div *ngIf="f['originCountry'].errors['minlength']">Country name must be at least 2 characters</div>
                      <div *ngIf="f['originCountry'].errors['maxlength']">Country name cannot exceed 100 characters</div>
                    </div>
                    <small class="text-muted">{{fieldInstructions.originCountry}}</small>
                  </div>

                  <div class="col-md-6">
                    <div class="form-check form-switch">
                      <input class="form-check-input" type="checkbox" id="isPerishable" formControlName="isPerishable">
                      <label class="form-check-label" for="isPerishable">Perishable Item</label>
                    </div>
                    <small class="text-muted">{{fieldInstructions.isPerishable}}</small>
                  </div>

                  <div class="col-12">
                    <label for="storageInstructions" class="form-label fw-bold">Storage Instructions</label>
                    <textarea class="form-control" id="storageInstructions" rows="2" formControlName="storageInstructions"
                      placeholder="Enter storage instructions" [ngClass]="{'is-invalid': submitted && f['storageInstructions'].errors}"></textarea>
                    <div *ngIf="submitted && f['storageInstructions'].errors" class="invalid-feedback">
                      <div *ngIf="f['storageInstructions'].errors['required']">Storage instructions are required for perishable items</div>
                      <div *ngIf="f['storageInstructions'].errors['minlength']">Storage instructions must be at least 10 characters</div>
                      <div *ngIf="f['storageInstructions'].errors['maxlength']">Storage instructions cannot exceed 500 characters</div>
                    </div>
                    <small class="text-muted">{{fieldInstructions.storageInstructions}}</small>
                  </div>

                  <div class="col-md-6">
                    <div class="form-check form-switch">
                      <input class="form-check-input" type="checkbox" id="isActive" formControlName="isActive">
                      <label class="form-check-label" for="isActive">Active Ingredient</label>
                    </div>
                    <small class="text-muted">{{fieldInstructions.isActive}}</small>
                  </div>
                </div>
              </div>
            </div>

            <!-- Fixed bottom action buttons -->
            <div class="position-sticky bottom-0 bg-white pt-3 border-top mt-3">
              <div class="d-flex gap-2 justify-content-end">
                <button type="button" class="btn btn-secondary" routerLink="/ingredients">
                  <i class="fas fa-times me-2"></i>Cancel
                </button>
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-save me-2"></i>Update Ingredient
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
    
    <div class="col-md-3">
      <div class="card bg-light border-0 shadow-sm">
        <div class="card-body">
          <h5 class="card-title mb-3">
            <i class="fas fa-lightbulb text-warning me-2"></i>
            Tips for Editing Ingredients
          </h5>
          <ul class="list-unstyled mb-0">
            <li class="mb-2">
              <i class="fas fa-check-circle text-success me-2"></i>
              Review and update ingredient name if needed
            </li>
            <li class="mb-2">
              <i class="fas fa-check-circle text-success me-2"></i>
              Verify unit of measure is appropriate
            </li>
            <li class="mb-2">
              <i class="fas fa-check-circle text-success me-2"></i>
              Update cost if it has changed
            </li>
            <li class="mb-2">
              <i class="fas fa-check-circle text-success me-2"></i>
              Maintain accurate stock levels
            </li>
            <li class="mb-2">
              <i class="fas fa-check-circle text-success me-2"></i>
              Check storage requirements for perishables
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
